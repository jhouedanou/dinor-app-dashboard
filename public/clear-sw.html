<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nettoyage Service Workers</title>
</head>
<body>
    <h1>ğŸ§¹ Nettoyage des Service Workers</h1>
    <p id="status">Nettoyage en cours...</p>
    
    <script>
    async function cleanAllServiceWorkers() {
        const status = document.getElementById('status');
        
        if ('serviceWorker' in navigator) {
            try {
                // DÃ©senregistrer tous les service workers
                const registrations = await navigator.serviceWorker.getRegistrations();
                
                for (let registration of registrations) {
                    await registration.unregister();
                    console.log('ğŸ—‘ï¸ Service Worker dÃ©sinscrit:', registration.scope);
                }
                
                // Nettoyer tous les caches
                if ('caches' in window) {
                    const cacheNames = await caches.keys();
                    await Promise.all(
                        cacheNames.map(cacheName => {
                            console.log('ğŸ—‘ï¸ Cache supprimÃ©:', cacheName);
                            return caches.delete(cacheName);
                        })
                    );
                }
                
                status.innerHTML = `
                    âœ… Nettoyage terminÃ© !<br>
                    ğŸ—‘ï¸ ${registrations.length} Service Worker(s) supprimÃ©(s)<br>
                    ğŸ—‘ï¸ Tous les caches supprimÃ©s<br><br>
                    <strong>Rechargez maintenant la page Filament :</strong><br>
                    <a href="/admin/login" style="color: blue; text-decoration: underline;">
                        ğŸ“± AccÃ©der Ã  Filament Admin
                    </a>
                `;
                
            } catch (error) {
                status.innerHTML = 'âŒ Erreur: ' + error.message;
            }
        } else {
            status.innerHTML = 'âš ï¸ Service Workers non supportÃ©s par ce navigateur';
        }
    }
    
    // DÃ©marrer le nettoyage automatiquement
    cleanAllServiceWorkers();
    </script>
</body>
</html> 
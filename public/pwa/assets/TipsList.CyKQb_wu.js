import{e as t,v as a,l as e,f as s,t as i,J as n,F as l,m as o,g as r,y as c,b as d,r as u,h as p,q as m,k as v,o as y}from"./vendor.CgTKjNNK.js";import{_ as h,A as g,b}from"./index.BVqTe4Wo.js";import{B as k,u as f}from"./BannerSection.DmzHC45h.js";import{F as w}from"./FavoriteButton.17FCFdzl.js";import{L as A}from"./LikeButton.d8wMjEdR.js";import"./useApi.5h5onROK.js";const B={class:"tips-list"},j={key:0,class:"loading-state"},_={key:1,class:"error-state"},L={class:"md3-body-large dinor-text-gray"},T={key:2,class:"empty-state"},D={key:3,class:"content"},C={class:"tips-grid"},F=["onClick"],M={class:"tip-content"},S={class:"tip-title md3-title-medium"},x={key:0,class:"tip-description md3-body-medium dinor-text-gray"},E={class:"tip-meta"},q={key:0,class:"time"},R={class:"tip-stats"},V={class:"stat"},z={class:"stat"},I={key:0,class:"stat"};const J=h({name:"TipsList",components:{FavoriteButton:w,LikeButton:A,AuthModal:g,BannerSection:k},setup(){const t=v(),{banners:a,loadBannersForContentType:e}=f(),s=d(()=>a.value),i=u([]),n=u(!1),l=u(null),o=u(!1),r=async()=>{n.value=!0,l.value=null;try{const t=await b.getTips();if(!t.success)throw new Error(t.message||"Failed to fetch tips");i.value=t.data}catch(t){l.value=t.message,console.error("Error fetching tips:",t)}finally{n.value=!1}},c=t=>{const{type:a,id:e,liked:s,count:n}=t.detail;if("tip"===a){const t=i.value.find(t=>t.id==e);t&&(t.is_liked=s,t.likes_count=n)}};return p(async()=>{await e("tips",!0),r(),window.addEventListener("like-updated",c)}),m(()=>{window.removeEventListener("like-updated",c)}),{tips:i,loading:n,error:l,showAuthModal:o,bannersByType:s,goToTip:a=>{t.push(`/tip/${a}`)},retry:()=>{l.value=null,r()},getDifficultyLabel:t=>({beginner:"D√©butant",intermediate:"Interm√©diaire",advanced:"Avanc√©"}[t]||t),getShortDescription:t=>{if(!t)return"";const a=t.replace(/<[^>]*>/g,"");return a.length>150?a.substring(0,150)+"...":a},formatDate:t=>new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}}},[["render",function(d,u,p,m,v,h){const g=e("BannerSection"),b=e("LikeButton"),k=e("FavoriteButton"),f=e("AuthModal");return y(),t("div",B,[a(g,{type:"tips",section:"hero",banners:m.bannersByType},null,8,["banners"]),m.loading?(y(),t("div",j,u[6]||(u[6]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"Chargement des astuces...",-1)]))):m.error?(y(),t("div",_,[u[7]||(u[7]=s("div",{class:"error-icon"},[s("span",{class:"material-symbols-outlined"},"error"),s("span",{class:"emoji-fallback"},"‚ö†Ô∏è")],-1)),u[8]||(u[8]=s("h2",{class:"md3-title-large"},"Erreur de chargement",-1)),s("p",L,i(m.error),1),s("button",{onClick:u[0]||(u[0]=(...t)=>m.retry&&m.retry(...t)),class:"btn-secondary"},"R√©essayer")])):m.loading||0!==m.tips.length?(y(),t("div",D,[s("div",C,[(y(!0),t(l,null,o(m.tips,e=>(y(),t("div",{key:e.id,class:"tip-card md3-card md3-ripple",onClick:t=>m.goToTip(e.id)},[u[14]||(u[14]=s("div",{class:"tip-icon"},[s("span",{class:"material-symbols-outlined"},"lightbulb"),s("span",{class:"emoji-fallback"},"üí°")],-1)),s("div",M,[s("h3",S,i(e.title),1),e.content?(y(),t("p",x,i(m.getShortDescription(e.content)),1)):r("",!0),s("div",E,[e.created_at?(y(),t("div",q,[u[10]||(u[10]=s("span",{class:"material-symbols-outlined"},"schedule",-1)),u[11]||(u[11]=s("span",{class:"emoji-fallback"},"‚è∞",-1)),s("span",null,i(m.formatDate(e.created_at)),1)])):r("",!0)]),s("div",R,[s("div",V,[a(b,{type:"tip","item-id":e.id,"initial-liked":e.is_liked||!1,"initial-count":e.likes_count||0,"show-count":!0,size:"small",variant:"minimal",onAuthRequired:u[1]||(u[1]=t=>m.showAuthModal=!0),onClick:u[2]||(u[2]=c(()=>{},["stop"]))},null,8,["item-id","initial-liked","initial-count"])]),s("div",z,[a(k,{type:"tip","item-id":e.id,"initial-favorited":!1,"initial-count":e.favorites_count||0,"show-count":!0,size:"small",variant:"minimal",onAuthRequired:u[3]||(u[3]=t=>m.showAuthModal=!0),onClick:u[4]||(u[4]=c(()=>{},["stop"]))},null,8,["item-id","initial-count"])]),e.category?(y(),t("div",I,[u[12]||(u[12]=s("span",{class:"material-symbols-outlined"},"category",-1)),u[13]||(u[13]=s("span",{class:"emoji-fallback"},"üè∑Ô∏è",-1)),s("span",null,i(e.category.name),1)])):r("",!0)])])],8,F))),128))])])):(y(),t("div",T,u[9]||(u[9]=[n('<div class="empty-icon" data-v-74c37c45><span class="material-symbols-outlined" data-v-74c37c45>lightbulb</span><span class="emoji-fallback" data-v-74c37c45>üí°</span></div><h2 class="md3-title-medium" data-v-74c37c45>Aucune astuce trouv√©e</h2><p class="md3-body-medium dinor-text-gray" data-v-74c37c45> Aucune astuce n&#39;est disponible pour le moment. </p>',3)]))),a(f,{modelValue:m.showAuthModal,"onUpdate:modelValue":u[5]||(u[5]=t=>m.showAuthModal=t)},null,8,["modelValue"])])}],["__scopeId","data-v-74c37c45"]]);export{J as default};

import{a as e}from"./useApi.D2XN-DnO.js";import{r as n,u as t,B as s,v as a,F as r,y as o,P as i,z as l,x as u,t as c,A as d,o as y}from"./vendor.hA9YLfwd.js";import{_ as p,D as b}from"./index.BcZTeLW-.js";function h(){const{request:t}=e(),s=n([]),a=n(!1),r=n(null),o=async(e={},n=!1)=>{a.value=!0,r.value=null;try{const a={};e.position&&(a.position=e.position),e.type_contenu&&(a.type_contenu=e.type_contenu),e.section&&(a.section=e.section),console.log("üåê [useBanners] Requ√™te API /banners avec params:",a);const o=n?{forceRefresh:!0}:{},i=await t("/banners",{params:a,...o});console.log("üì¶ [useBanners] R√©ponse API:",i),i.success?(s.value=i.data,console.log(`‚úÖ [useBanners] ${i.data.length} banni√®res charg√©es`)):(r.value=i.message||"Erreur lors du chargement des banni√®res",console.error("‚ùå [useBanners] Erreur:",r.value))}catch(o){r.value="Impossible de charger les banni√®res",console.error("‚ùå [useBanners] Exception:",o)}finally{a.value=!1}};return{banners:s,loading:a,error:r,loadBanners:o,loadBannersByType:async e=>{a.value=!0,r.value=null;try{const n=await t(`/banners/type/${e}`);return n.success?(s.value=n.data,n.data):(r.value=n.message||"Erreur lors du chargement des banni√®res",[])}catch(n){return r.value="Impossible de charger les banni√®res pour ce type",console.error("Erreur banni√®res par type:",n),[]}finally{a.value=!1}},loadBannersForContentType:async(e,n=!1)=>(console.log(`üéØ [useBanners] Chargement des banni√®res pour type: ${e}`),await o({type_contenu:e,position:"home"===e?"home":"content"},n)),clearBannersCache:()=>(console.log("üóëÔ∏è [useBanners] Vidage du cache des banni√®res"),s.value=[],o({},!0)),getBanner:async e=>{try{const n=await t(`/banners/${e}`);if(n.success)return n.data;throw new Error(n.message||"Banni√®re non trouv√©e")}catch(n){throw console.error("Erreur r√©cup√©ration banni√®re:",n),n}},getActiveBanners:()=>s.value.filter(e=>e.is_active),getBannersByPosition:e=>s.value.filter(n=>n.position===e||"all_pages"===n.position),getBannersBySection:e=>s.value.filter(n=>n.section===e),getBannersByTypeAndSection:(e,n)=>s.value.filter(t=>t.type_contenu===e&&t.section===n)}}const v={name:"BannerSection",components:{DinorIcon:b},props:{type:{type:String,required:!0,validator:e=>["recipes","tips","events","dinor_tv","pages","home"].includes(e)},section:{type:String,default:"hero",validator:e=>["header","hero","featured","footer"].includes(e)},banners:{type:Array,default:()=>[]},autoPlay:{type:Boolean,default:!0},interval:{type:Number,default:5e3}},data:()=>({currentSlide:0,isTransitioning:!1,autoPlayInterval:null,isPaused:!1}),computed:{visibleBanners(){return this.banners.filter(e=>e.image_url)}},watch:{visibleBanners:{handler(){this.currentSlide=0,this.setupAutoPlay()},immediate:!0}},mounted(){this.setupAutoPlay()},beforeUnmount(){this.clearAutoPlay()},methods:{setupAutoPlay(){this.clearAutoPlay(),this.autoPlay&&this.visibleBanners.length>1&&!this.isPaused&&(this.autoPlayInterval=setInterval(()=>{this.isPaused||this.nextSlide()},this.interval))},pauseAutoPlay(){this.isPaused=!0,this.clearAutoPlay()},resumeAutoPlay(){this.isPaused=!1,this.setupAutoPlay()},clearAutoPlay(){this.autoPlayInterval&&(clearInterval(this.autoPlayInterval),this.autoPlayInterval=null)},goToSlide(e){this.isTransitioning||e===this.currentSlide||(this.isTransitioning=!0,this.currentSlide=e,setTimeout(()=>{this.isTransitioning=!1},500),this.setupAutoPlay())},nextSlide(){const e=(this.currentSlide+1)%this.visibleBanners.length;this.goToSlide(e)},prevSlide(){const e=0===this.currentSlide?this.visibleBanners.length-1:this.currentSlide-1;this.goToSlide(e)},getBannerStyle:e=>({backgroundColor:e.background_color||"#E1251B",color:e.text_color||"#FFFFFF"}),getBannerButtonStyle(e){return{backgroundColor:e.button_color||"#FFFFFF",color:this.getContrastColor(e.button_color||"#FFFFFF"),border:`2px solid ${e.button_color||"#FFFFFF"}`}},getContrastColor:e=>(299*parseInt(e.slice(1,3),16)+587*parseInt(e.slice(3,5),16)+114*parseInt(e.slice(5,7),16))/1e3>128?"#000000":"#FFFFFF",handleButtonClick(e){e.startsWith("/")?this.$router.push(e):e.startsWith("http")?window.open(e,"_blank"):this.$router.push(e)},playDemoVideo(e){e&&window.open(e,"_blank")}}},g={class:"banner-content"},F={key:3,class:"banner-video"},B=["onClick"],m=["onClick"],_={key:0,class:"carousel-controls"},P={class:"carousel-indicators"},S=["onClick","aria-label"],k={class:"carousel-nav"},f=["disabled"],A=["disabled"];const C=p(v,[["render",function(e,n,p,b,h,v){const C=d("DinorIcon");return v.visibleBanners&&v.visibleBanners.length>0?(y(),t("section",{key:0,class:l(["banner-section",`banner-section--${p.section}`])},[a("div",{class:"banner-carousel",ref:"carousel",onMouseenter:n[0]||(n[0]=(...e)=>v.pauseAutoPlay&&v.pauseAutoPlay(...e)),onMouseleave:n[1]||(n[1]=(...e)=>v.resumeAutoPlay&&v.resumeAutoPlay(...e))},[(y(!0),t(r,null,o(v.visibleBanners,(e,r)=>(y(),t("div",{key:e.id,class:l(["banner-item",{active:r===h.currentSlide}]),style:i(v.getBannerStyle(e))},[e.image_url?(y(),t("div",{key:0,class:"banner-background",style:i({backgroundImage:`url(${e.image_url})`})},null,4)):s("",!0),a("div",g,[e.titre?(y(),t("h2",{key:0,class:"banner-title",style:i({color:e.text_color||"#FFFFFF"})},u(e.titre),5)):s("",!0),e.sous_titre?(y(),t("h3",{key:1,class:"banner-subtitle",style:i({color:e.text_color||"#FFFFFF"})},u(e.sous_titre),5)):s("",!0),e.description?(y(),t("p",{key:2,class:"banner-description",style:i({color:e.text_color||"#FFFFFF"})},u(e.description),5)):s("",!0),e.demo_video_url?(y(),t("div",F,[a("button",{onClick:n=>v.playDemoVideo(e.demo_video_url),class:"video-play-button",style:i({color:e.text_color||"#FFFFFF"})},[c(C,{name:"play_circle",size:20}),n[4]||(n[4]=a("span",null,"Voir la d√©mo",-1))],12,B)])):s("",!0),e.button_text&&e.button_url?(y(),t("button",{key:4,class:"banner-button",style:i(v.getBannerButtonStyle(e)),onClick:n=>v.handleButtonClick(e.button_url)},u(e.button_text),13,m)):s("",!0)])],6))),128))],544),v.visibleBanners.length>1?(y(),t("div",_,[a("div",P,[(y(!0),t(r,null,o(v.visibleBanners,(e,n)=>(y(),t("button",{key:`indicator-${e.id}`,class:l(["indicator",{active:n===h.currentSlide}]),onClick:e=>v.goToSlide(n),"aria-label":`Aller √† la banni√®re ${n+1}`},null,10,S))),128))]),a("div",k,[a("button",{class:"nav-btn prev-btn",onClick:n[2]||(n[2]=(...e)=>v.prevSlide&&v.prevSlide(...e)),disabled:h.isTransitioning,"aria-label":"Banni√®re pr√©c√©dente"},[c(C,{name:"chevron_left",size:24})],8,f),a("button",{class:"nav-btn next-btn",onClick:n[3]||(n[3]=(...e)=>v.nextSlide&&v.nextSlide(...e)),disabled:h.isTransitioning,"aria-label":"Banni√®re suivante"},[c(C,{name:"chevron_right",size:24})],8,A)])])):s("",!0)],2)):s("",!0)}],["__scopeId","data-v-48c19319"]]);export{C as B,h as u};

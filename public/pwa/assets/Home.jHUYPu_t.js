import{b as e,r as t,g as a,s as i,K as l,h as r,i as o,k as n,t as s,x as c,A as d,l as u,j as v,F as m,E as g,q as p,n as f,p as h,o as _,z as y,e as b}from"./vendor.Bvrl98ec.js";import{u as k}from"./useApi.iywkp8tM.js";import{B as w,u as D}from"./BannerSection.BFUczTMl.js";import{u as C,_ as A,D as E,A as T,a as R}from"./index.rhAE6Ehn.js";import{L as I}from"./LikeButton.BkuLNhLJ.js";const L=window.location.origin,S={recipe:"/images/default-recipe.jpg",tip:"/images/default-content.jpg",tips:"/images/default-content.jpg",event:"/images/default-event.jpg",events:"/images/default-event.jpg",dinor_tv:"/images/default-video.jpg",video:"/images/default-video.jpg",videos:"/images/default-video.jpg",banner:"/images/default-content.jpg",banners:"/images/default-content.jpg",user:"/images/default-content.jpg",users:"/images/default-content.jpg",content:"/images/default-content.jpg"};function V(e,t="content"){return e&&""!==e.trim()?e.startsWith("http")?e:e.startsWith("/")?`${L}${e}`:e.startsWith("storage/")||e.startsWith("tips/")||e.startsWith("recipes/")||e.startsWith("events/")||e.startsWith("banners/")?`${L}/storage/${e}`:`${L}/images/${e}`:S[t]||S.content}function $(e){return V((null==e?void 0:e.featured_image_url)||(null==e?void 0:e.image_url)||(null==e?void 0:e.image),"recipe")}function j(e){return V((null==e?void 0:e.featured_image_url)||(null==e?void 0:e.image_url)||(null==e?void 0:e.image),"tip")}function M(e){return V((null==e?void 0:e.featured_image_url)||(null==e?void 0:e.image_url)||(null==e?void 0:e.image),"event")}function z(e){return V((null==e?void 0:e.thumbnail_url)||(null==e?void 0:e.image_url)||(null==e?void 0:e.featured_image_url)||(null==e?void 0:e.image),"video")}function B(e,t){return Array.isArray(e)?e.map(e=>function(e,t){if(!e)return e;const a={...e};switch(t){case"tip":case"tips":a.featured_image_url&&(a.featured_image_url=j(a)),a.image_url&&(a.image_url=j(a));break;case"recipe":case"recipes":a.featured_image_url&&(a.featured_image_url=$(a)),a.image_url&&(a.image_url=$(a));break;case"event":case"events":a.featured_image_url&&(a.featured_image_url=M(a)),a.image_url&&(a.image_url=M(a));break;case"video":case"videos":case"dinor_tv":a.thumbnail_url&&(a.thumbnail_url=z(a)),a.featured_image_url&&(a.featured_image_url=z(a)),a.image_url&&(a.image_url=z(a));break;default:a.featured_image_url&&(a.featured_image_url=V(a.featured_image_url,t)),a.image_url&&(a.image_url=V(a.image_url,t)),a.image&&(a.image=V(a.image,t))}return a}(e,t)):e}function F(){const e=C(),l=t(new Set),r=t(!1),o={emit(e,t){console.log("ðŸ”„ [RefreshBus] Ã‰mission Ã©vÃ©nement:",e,t);const a=new CustomEvent(e,{detail:t});window.dispatchEvent(a)},on:(e,t)=>(console.log("ðŸ‘‚ [RefreshBus] Ã‰coute Ã©vÃ©nement:",e),window.addEventListener(e,t),()=>window.removeEventListener(e,t))},n=async(t,a={})=>{if(!r.value||a.force){r.value=!0,console.log(`ðŸ”„ [Refresh] DÃ©but rafraÃ®chissement: ${t}`);try{if(e.invalidateCache(`/${t}`),"caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>{if(e.includes(t)||e.includes("api"))return console.log(`ðŸ—‘ï¸ [Refresh] Suppression cache: ${e}`),caches.delete(e)}))}o.emit("content-refresh",{type:t,timestamp:Date.now(),source:"manual"}),console.log(`âœ… [Refresh] RafraÃ®chissement terminÃ©: ${t}`)}catch(i){throw console.error(`âŒ [Refresh] Erreur rafraÃ®chissement ${t}:`,i),i}finally{r.value=!1}}else console.log("â³ [Refresh] RafraÃ®chissement dÃ©jÃ  en cours")},s=async()=>{console.log("ðŸ”„ [Refresh] RafraÃ®chissement global");const e=["recipes","tips","events","dinor_tv","banners"];for(const t of e)await n(t,{force:!0})};return a(()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.addEventListener("controllerchange",()=>{console.log("ðŸ”„ [PWA] Service Worker mis Ã  jour, rafraÃ®chissement des donnÃ©es"),s()}),navigator.serviceWorker.addEventListener("message",e=>{var t;if("CACHE_UPDATED"===(null==(t=e.data)?void 0:t.type)){console.log("ðŸ”„ [PWA] Cache mis Ã  jour:",e.data.url);const t=e.data.url;let a=null;t.includes("/recipes")?a="recipes":t.includes("/tips")?a="tips":t.includes("/events")?a="events":t.includes("/dinor-tv")&&(a="dinor_tv"),a&&n(a)}}))}),i(()=>{l.value.forEach(e=>e()),l.value.clear()}),{isRefreshing:r,refreshContentType:n,refreshAll:s,onRefresh:(e,t={})=>{const a=o.on("content-refresh",a=>{const{type:i,timestamp:l,source:r}=a.detail;console.log("ðŸ“¡ [Refresh] Ã‰vÃ©nement reÃ§u:",{type:i,timestamp:l,source:r}),t.contentType&&t.contentType!==i||e(a)});return l.value.add(a),a},setupAutoRefresh:(e=3e5)=>{let t=null,a=Date.now();const i=()=>{a=Date.now()},l=["click","scroll","keypress","touchstart"];return l.forEach(e=>{document.addEventListener(e,i,{passive:!0})}),t=setInterval(async()=>{if(Date.now()-a>12e4)console.log("ðŸ˜´ [AutoRefresh] Utilisateur inactif, pas de rafraÃ®chissement");else{console.log("ðŸ”„ [AutoRefresh] RafraÃ®chissement automatique");try{await s()}catch(e){console.error("âŒ [AutoRefresh] Erreur:",e)}}},e),()=>{t&&clearInterval(t),l.forEach(e=>{document.removeEventListener(e,i)})}},refreshBus:o}}const x={name:"ContentCarousel",components:{DinorIcon:E},props:{title:{type:String,required:!0},items:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},contentType:{type:String,required:!0,validator:e=>["recipes","tips","events","videos"].includes(e)},viewAllLink:{type:String,required:!0},showControls:{type:Boolean,default:!0},showIndicators:{type:Boolean,default:!1},itemsPerView:{type:Number,default:4},disableAutoNavigation:{type:Boolean,default:!1}},emits:["item-click"],setup(e,{emit:r}){const o=h(),n=t(null),s=t(0),c=t(!1),d=t(!0),u=()=>{const e=n.value;e&&(c.value=e.scrollLeft>0,d.value=e.scrollLeft<e.scrollWidth-e.clientWidth)},v=()=>V(null,e.contentType);return a(async()=>{await l(),u();const e=n.value;e&&e.addEventListener("scroll",u)}),i(()=>{const e=n.value;e&&e.removeEventListener("scroll",u)}),{carouselRef:n,currentIndex:s,canScrollLeft:c,canScrollRight:d,scrollCarousel:e=>{var t;const a=n.value;if(!a)return;const i=2*(((null==(t=a.querySelector(".carousel-item"))?void 0:t.offsetWidth)||280)+16);a.scrollBy({left:e*i,behavior:"smooth"}),setTimeout(u,300)},scrollToIndex:e=>{var t;const a=n.value;if(!a)return;const i=e*(((null==(t=a.querySelector(".carousel-item"))?void 0:t.offsetWidth)||280)+16);a.scrollTo({left:i,behavior:"smooth"}),s.value=e},handleItemClick:t=>{r("item-click",t);const a={recipes:`/recipe/${t.id}`,tips:`/tip/${t.id}`,events:`/event/${t.id}`,videos:`/video/${t.id}`}[e.contentType];a&&!e.disableAutoNavigation&&o.push(a)},getShortDescription:e=>{if(!e)return"Aucune description disponible";return e.length>100?e.substring(0,100)+"...":e},formatDate:e=>{if(!e)return"";return new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})},formatDuration:e=>{if(!e)return"";return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`},getDifficultyLabel:e=>({easy:"Facile",medium:"Moyen",hard:"Difficile",beginner:"DÃ©butant",intermediate:"IntermÃ©diaire",advanced:"AvancÃ©"}[e]||e||"Non spÃ©cifiÃ©"),getStatusLabel:e=>({active:"Actif",upcoming:"Ã€ venir",completed:"TerminÃ©",cancelled:"AnnulÃ©",draft:"Brouillon",published:"PubliÃ©"}[e]||e||"Non dÃ©fini"),getStatusClass:e=>`status-${e}`,getItemClass:()=>`content-${e.contentType}`,getTypeIcon:()=>({recipes:"restaurant",tips:"lightbulb",events:"event",videos:"play_circle"}[e.contentType]||"info"),getTotalTime:t=>{if("recipes"===e.contentType){const e=(t.preparation_time||0)+(t.cooking_time||0)+(t.resting_time||0);return e>0?e:null}return t.estimated_time||t.preparation_time||null},getDefaultImage:v,getVideoThumbnail:e=>{if((null==e?void 0:e.includes("youtube.com"))||(null==e?void 0:e.includes("youtu.be"))){return`https://img.youtube.com/vi/${e.split("v=")[1]||e.split("/").pop()}/maxresdefault.jpg`}return"/images/default-video-thumbnail.jpg"},handleImageError:e=>{e.target.src=v()},getImageUrl:V}}},W={class:"content-carousel"},U={class:"section-header"},H={class:"carousel-container"},q={key:0,class:"carousel-loading"},P={key:1,class:"carousel-error"},N={key:2,class:"carousel-empty"},O={key:3,class:"carousel-wrapper"},K=["onClick"],G={class:"default-card"},J={key:0,class:"card-image"},Q=["src","alt"],X={class:"card-overlay"},Y={key:0,class:"time-badge"},Z={key:1,class:"card-icon"},ee={class:"card-content"},te={class:"card-meta"},ae={key:0,class:"likes"},ie={key:1,class:"favorites"},le={key:2,class:"date"},re={key:3,class:"difficulty"},oe={key:0,class:"carousel-controls"},ne=["disabled"],se=["disabled"],ce={key:1,class:"carousel-indicators"},de=["onClick"];const ue={class:"video-player"},ve=["src","title"],me={key:1,class:"video-error"},ge={class:"video-details"},pe={key:0},fe={class:"video-meta"},he={key:0,class:"views"},_e={key:1,class:"date"};const ye={class:"home"},be={class:"content-area"},ke={class:"recipe-card"},we={class:"card-image"},De=["src","alt"],Ce={class:"card-overlay"},Ae={key:0,class:"time-badge"},Ee={key:1,class:"difficulty-badge"},Te={class:"card-content"},Re={class:"card-meta"},Ie={class:"likes"},Le={class:"date"},Se={class:"tip-card"},Ve={class:"tip-icon"},$e={class:"card-content"},je={class:"card-meta"},Me={key:0,class:"time"},ze={class:"difficulty"},Be={class:"date"},Fe={class:"event-card"},xe={class:"card-image"},We=["src","alt"],Ue={class:"card-overlay"},He={class:"card-content"},qe={class:"card-meta"},Pe={class:"date"},Ne={class:"created"},Oe={class:"video-card"},Ke={class:"video-thumbnail"},Ge=["src","alt"],Je={class:"video-overlay"},Qe={class:"play-button"},Xe={key:0,class:"live-badge"},Ye={key:1,class:"duration-badge"},Ze={class:"card-content"},et={class:"card-meta"},tt={class:"views"},at={class:"date"};const it=A({name:"Home",components:{ContentCarousel:A(x,[["render",function(e,t,a,i,l,h){const y=u("DinorIcon"),b=u("router-link");return _(),r("section",W,[o("div",U,[o("h2",null,s(a.title),1),n(b,{to:a.viewAllLink,class:"see-all-btn"},{default:c(()=>[t[3]||(t[3]=d(" Voir tout ")),n(y,{name:"arrow_forward",size:18})]),_:1,__:[3]},8,["to"])]),o("div",H,[a.loading?(_(),r("div",q,t[4]||(t[4]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"Chargement...",-1)]))):a.error?(_(),r("div",P,[n(y,{name:"error",size:48}),t[5]||(t[5]=o("p",null,"Erreur lors du chargement",-1))])):0===a.items.length?(_(),r("div",N,[n(y,{name:"info",size:48}),t[6]||(t[6]=o("p",null,"Aucun contenu disponible",-1))])):(_(),r("div",O,[o("div",{class:"carousel",ref:i.carouselRef},[(_(!0),r(m,null,g(a.items,l=>(_(),r("div",{key:l.id,onClick:e=>i.handleItemClick(l),class:p(["carousel-item",i.getItemClass()])},[f(e.$slots,"item",{item:l,getShortDescription:i.getShortDescription},()=>[o("div",G,[l.featured_image_url||l.image_url?(_(),r("div",J,[o("img",{src:i.getImageUrl(l.featured_image_url||l.image_url,a.contentType),alt:l.title,loading:"lazy",onError:t[0]||(t[0]=(...e)=>i.handleImageError&&i.handleImageError(...e))},null,40,Q),o("div",X,[i.getTotalTime(l)?(_(),r("span",Y,s(i.getTotalTime(l))+"min ",1)):v("",!0),l.status?(_(),r("span",{key:1,class:p([i.getStatusClass(l.status),"status-badge"])},s(i.getStatusLabel(l.status)),3)):v("",!0)])])):(_(),r("div",Z,[n(y,{name:i.getTypeIcon(),size:32},null,8,["name"])])),o("div",ee,[o("h3",null,s(l.title),1),o("p",null,s(i.getShortDescription(l.short_description||l.content||l.description)),1),o("div",te,[l.likes_count?(_(),r("span",ae,[n(y,{name:"thumb_up",size:16}),d(" "+s(l.likes_count),1)])):v("",!0),l.favorites_count?(_(),r("span",ie,[n(y,{name:"favorite",size:16}),d(" "+s(l.favorites_count),1)])):v("",!0),l.created_at?(_(),r("span",le,s(i.formatDate(l.created_at)),1)):v("",!0),l.difficulty_level?(_(),r("span",re,s(i.getDifficultyLabel(l.difficulty_level)),1)):v("",!0)])])])])],10,K))),128))],512),a.showControls&&a.items.length>1?(_(),r("div",oe,[o("button",{onClick:t[1]||(t[1]=e=>i.scrollCarousel(-1)),class:"carousel-btn prev",disabled:!i.canScrollLeft},[n(y,{name:"chevron_left",size:24})],8,ne),o("button",{onClick:t[2]||(t[2]=e=>i.scrollCarousel(1)),class:"carousel-btn next",disabled:!i.canScrollRight},[n(y,{name:"chevron_right",size:24})],8,se)])):v("",!0),a.showIndicators&&a.items.length>1?(_(),r("div",ce,[(_(!0),r(m,null,g(a.items,(e,t)=>(_(),r("button",{key:t,onClick:e=>i.scrollToIndex(t),class:p(["indicator",{active:i.currentIndex===t}])},null,10,de))),128))])):v("",!0)]))])])}],["__scopeId","data-v-654fcc20"]]),BannerSection:w,DinorIcon:E,LikeButton:I,AuthModal:T,VideoModal:A({name:"VideoModal",components:{DinorIcon:E},props:{video:{type:Object,required:!0}},emits:["close"],setup(t,{emit:a}){const i=e(()=>l(t.video.video_url)),l=e=>{if(!e)return"";const t=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return t?`https://www.youtube.com/embed/${t[1]}?autoplay=1&rel=0`:e};return{closeModal:()=>{a("close")},embedUrl:i,getEmbedUrl:l,formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}):"",onVideoLoad:()=>{console.log("ðŸŽ¬ [VideoModal] VidÃ©o chargÃ©e avec succÃ¨s")},onVideoError:()=>{console.error("âŒ [VideoModal] Erreur lors du chargement de la vidÃ©o")}}}},[["render",function(e,t,a,i,l,c){const m=u("DinorIcon");return _(),r("div",{class:"video-modal",onClick:t[4]||(t[4]=(...e)=>i.closeModal&&i.closeModal(...e))},[o("div",{class:"modal-content",onClick:t[3]||(t[3]=y(()=>{},["stop"]))},[o("button",{onClick:t[0]||(t[0]=(...e)=>i.closeModal&&i.closeModal(...e)),class:"close-button"},[n(m,{name:"close",size:24})]),o("div",ue,[i.embedUrl?(_(),r("iframe",{key:0,src:i.embedUrl,title:a.video.title,frameborder:"0",allowfullscreen:"",onLoad:t[1]||(t[1]=(...e)=>i.onVideoLoad&&i.onVideoLoad(...e)),onError:t[2]||(t[2]=(...e)=>i.onVideoError&&i.onVideoError(...e))},null,40,ve)):(_(),r("div",me,[n(m,{name:"error",size:48}),t[5]||(t[5]=o("p",null,"URL de vidÃ©o non valide",-1))]))]),o("div",ge,[o("h3",null,s(a.video.title),1),a.video.description?(_(),r("p",pe,s(a.video.description),1)):v("",!0),o("div",fe,[a.video.views_count?(_(),r("span",he,[n(m,{name:"visibility",size:16}),d(" "+s(a.video.views_count)+" vues ",1)])):v("",!0),a.video.created_at?(_(),r("span",_e,s(i.formatDate(a.video.created_at)),1)):v("",!0)])])])])}],["__scopeId","data-v-b8707120"]])},setup(){const l=h(),{showAuthModal:r,authModalMessage:o,handleAuthError:n,closeAuthModal:s,handleAuthSuccess:c}=R(),{banners:d,loading:u,error:v,loadBannersForContentType:m}=D();a(async()=>{await m("home",!0)});const{recipes:g,error:p,loading:f,refresh:_}=function(t={},a={}){const{data:i,error:l,loading:r,execute:o,refresh:n}=k("/recipes",t,{cacheTTL:3e5,...a}),s=e(()=>{var e,t;return(null==(t=null==(e=i.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),c=e(()=>{var e,t;return(null==(t=null==(e=i.value)?void 0:e.data)?void 0:t.sort((e,t)=>(t.likes_count||0)-(e.likes_count||0)))||[]});return{recipes:i,featuredRecipes:s,popularRecipes:c,error:l,loading:r,execute:o,refresh:n}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{tips:y,error:b,loading:w,refresh:C}=function(t={},a={}){const{data:i,error:l,loading:r,execute:o,refresh:n}=k("/tips",t,{cacheTTL:3e5,...a}),s=e(()=>{if(!i.value)return i.value;const e={...i.value};return e.data&&Array.isArray(e.data)&&(e.data=B(e.data,"tips")),e}),c=e(()=>{var e,t;return(null==(t=null==(e=s.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),d=e(()=>{var e;const t={};return(null==(e=s.value)?void 0:e.data)&&s.value.data.forEach(e=>{const a=e.difficulty_level||"beginner";t[a]||(t[a]=[]),t[a].push(e)}),t});return{tips:s,featuredTips:c,tipsByDifficulty:d,error:l,loading:r,execute:o,refresh:n}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{events:A,error:E,loading:T,refresh:I}=function(t={},a={}){const{data:i,error:l,loading:r,execute:o,refresh:n}=k("/events",t,{cacheTTL:3e5,...a}),s=e(()=>{var e,t;return(null==(t=null==(e=i.value)?void 0:e.data)?void 0:t.filter(e=>"active"===e.status))||[]}),c=e(()=>{var e,t;return(null==(t=null==(e=i.value)?void 0:e.data)?void 0:t.filter(e=>new Date(e.date)>new Date).sort((e,t)=>new Date(e.date)-new Date(t.date)))||[]}),d=e(()=>{var e,t;return(null==(t=null==(e=i.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]});return{events:i,activeEvents:s,upcomingEvents:c,featuredEvents:d,error:l,loading:r,execute:o,refresh:n}}({limit:4,sort_by:"created_at",sort_order:"desc"}),{videos:L,error:S,loading:V,refresh:$}=function(t={},a={}){const{data:i,error:l,loading:r,execute:o,refresh:n}=k("/dinor-tv",t,{cacheTTL:6e5,...a}),s=e(()=>{var e,t;return(null==(t=null==(e=i.value)?void 0:e.data)?void 0:t.filter(e=>e.is_featured))||[]}),c=e(()=>{var e,t;return(null==(t=null==(e=i.value)?void 0:e.data)?void 0:t.sort((e,t)=>new Date(t.created_at)-new Date(e.created_at)))||[]}),d=e(()=>{var e;const t={};return(null==(e=i.value)?void 0:e.data)&&i.value.data.forEach(e=>{var a;const i=(null==(a=e.category)?void 0:a.name)||"Autres";t[i]||(t[i]=[]),t[i].push(e)}),t});return{videos:i,featuredVideos:s,latestVideos:c,videosByCategory:d,error:l,loading:r,execute:o,refresh:n}}({limit:4,sort_by:"created_at",sort_order:"desc"}),j=e(()=>{var e,t;return(null==(t=null==(e=g.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),M=e(()=>{var e,t;return(null==(t=null==(e=y.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),z=e(()=>{var e,t;return(null==(t=null==(e=A.value)?void 0:e.data)?void 0:t.slice(0,4))||[]}),x=e(()=>{var e,t;const a=(null==(t=null==(e=L.value)?void 0:e.data)?void 0:t.slice(0,4))||[];return console.log("ðŸ“º [Home] latestVideos computed:",a),a}),{onRefresh:W}=F(),U=e=>{const{type:t,id:a,liked:i,count:l}=e.detail;if("recipe"===t){const e=j.value.find(e=>e.id==a);e&&(e.is_liked=i,e.likes_count=l)}else if("tip"===t){const e=M.value.find(e=>e.id==a);e&&(e.is_liked=i,e.likes_count=l)}},H=e=>{const{type:t}=e.detail;switch(console.log(`ðŸ”„ [Home] RafraÃ®chissement dÃ©tectÃ© pour: ${t}`),t){case"recipes":console.log("ðŸ”„ [Home] Rechargement des recettes..."),g.value=null;break;case"tips":console.log("ðŸ”„ [Home] Rechargement des tips..."),y.value=null;break;case"events":console.log("ðŸ”„ [Home] Rechargement des Ã©vÃ©nements..."),A.value=null;break;case"dinor_tv":console.log("ðŸ”„ [Home] Rechargement des vidÃ©os..."),L.value=null}};let q=null;a(async()=>{var e,t,a,i,l,r,o,n;window.addEventListener("like-updated",U),q=W(H,{global:!0}),await new Promise(e=>setTimeout(e,1500)),(null==(t=null==(e=g.value)?void 0:e.data)?void 0:t.length)||_(),(null==(i=null==(a=y.value)?void 0:a.data)?void 0:i.length)||C(),(null==(r=null==(l=A.value)?void 0:l.data)?void 0:r.length)||I(),(null==(n=null==(o=L.value)?void 0:o.data)?void 0:n.length)||$()}),i(()=>{window.removeEventListener("like-updated",U),q&&q()});const P=e(()=>{var e,t,a,i,l,r,o,n;return{recipes:(null==(t=null==(e=g.value)?void 0:e.meta)?void 0:t.total)||j.value.length,tips:(null==(i=null==(a=y.value)?void 0:a.meta)?void 0:i.total)||M.value.length,events:(null==(r=null==(l=A.value)?void 0:l.meta)?void 0:r.total)||z.value.length,videos:(null==(n=null==(o=L.value)?void 0:o.meta)?void 0:n.total)||x.value.length}}),N=t(null),O=e=>{N.value=e,document.body.style.overflow="hidden"};return{banners:d,loadingBanners:u,errorBanners:v,latestRecipes:j,latestTips:M,latestEvents:z,latestVideos:x,stats:P,loadingRecipes:f,loadingTips:w,loadingEvents:T,loadingVideos:V,errorRecipes:p,errorTips:b,errorEvents:E,errorVideos:S,handleRecipeClick:e=>{l.push(`/recipe/${e.id}`)},handleTipClick:e=>{l.push(`/tip/${e.id}`)},handleEventClick:e=>{l.push(`/event/${e.id}`)},handleVideoClick:e=>{console.log("ðŸŽ¬ [Home] handleVideoClick appelÃ© avec:",e),console.log("ðŸŽ¬ [Home] video.video_url:",e.video_url),e.video_url&&e.video_url.trim()?(console.log("ðŸŽ¬ [Home] Ouverture vidÃ©o dans modal:",e.title),O(e)):console.warn("âš ï¸ [Home] URL de vidÃ©o manquante pour:",e.title)},getShortDescription:e=>{if(!e)return"";const t=e.replace(/<[^>]*>/g,"");return t.length>80?t.substring(0,80)+"...":t},getDifficultyLabel:e=>({beginner:"DÃ©butant",intermediate:"IntermÃ©diaire",advanced:"AvancÃ©",easy:"Facile",medium:"Moyen",hard:"Difficile"}[e]||e),getStatusClass:e=>`status-${e}`,getStatusLabel:e=>({active:"Actif",upcoming:"Ã€ venir",completed:"TerminÃ©",cancelled:"AnnulÃ©"}[e]||e),formatDate:e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"numeric",month:"short"}):"",getVideoThumbnail:e=>{if(!e)return"/images/default-video.jpg";const t=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return t?`https://img.youtube.com/vi/${t[1]}/maxresdefault.jpg`:"/images/default-video.jpg"},formatDuration:e=>{if(!e)return"";return`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`},getContrastColor:e=>(.299*parseInt(e.slice(1,3),16)+.587*parseInt(e.slice(3,5),16)+.114*parseInt(e.slice(5,7),16))/255>.5?"#000000":"#FFFFFF",showAuthModal:r,authModalMessage:o,handleAuthError:n,closeAuthModal:s,handleAuthSuccess:c,selectedVideo:N,playVideo:O,closeVideo:()=>{N.value=null,document.body.style.overflow="auto"},getEmbedUrl:e=>{if(!e)return"";const t=e.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);return t?`https://www.youtube.com/embed/${t[1]}?autoplay=1&rel=0`:e}}}},[["render",function(e,t,a,i,l,m){const g=u("BannerSection"),f=u("LikeButton"),h=u("ContentCarousel"),k=u("DinorIcon"),w=u("AuthModal"),D=u("VideoModal");return _(),r("div",ye,[o("div",be,[n(g,{type:"home",section:"hero",banners:i.banners},null,8,["banners"]),n(h,{title:"DerniÃ¨res Recettes",items:i.latestRecipes,loading:i.loadingRecipes,error:i.errorRecipes,"content-type":"recipes","view-all-link":"/recipes",onItemClick:i.handleRecipeClick},{item:c(({item:e})=>[o("div",ke,[o("div",we,[o("img",{src:e.featured_image_url||"/images/default-recipe.jpg",alt:e.title,loading:"lazy"},null,8,De),o("div",Ce,[e.total_time?(_(),r("span",Ae,s(e.total_time)+"min ",1)):v("",!0),e.difficulty?(_(),r("span",Ee,s(i.getDifficultyLabel(e.difficulty)),1)):v("",!0)])]),o("div",Te,[o("h3",null,s(e.title),1),o("p",null,s(i.getShortDescription(e.short_description)),1),o("div",Re,[o("span",Ie,[n(f,{type:"recipe","item-id":e.id,"initial-liked":e.is_liked||!1,"initial-count":e.likes_count||0,"show-count":!0,size:"small",variant:"minimal",onAuthRequired:i.handleAuthError,onClick:t[0]||(t[0]=y(()=>{},["stop"]))},null,8,["item-id","initial-liked","initial-count","onAuthRequired"])]),o("span",Le,s(i.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),n(h,{title:"DerniÃ¨res Astuces",items:i.latestTips,loading:i.loadingTips,error:i.errorTips,"content-type":"tips","view-all-link":"/tips",onItemClick:i.handleTipClick},{item:c(({item:e})=>[o("div",Se,[o("div",Ve,[n(k,{name:"lightbulb",size:48,color:"#FFFFFF"})]),o("div",$e,[o("h3",null,s(e.title),1),o("p",null,s(i.getShortDescription(e.content)),1),o("div",je,[e.estimated_time?(_(),r("span",Me,s(e.estimated_time)+"min ",1)):v("",!0),o("span",ze,s(i.getDifficultyLabel(e.difficulty_level)),1),o("span",Be,s(i.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),n(h,{title:"Derniers Ã‰vÃ©nements",items:i.latestEvents,loading:i.loadingEvents,error:i.errorEvents,"content-type":"events","view-all-link":"/events",onItemClick:i.handleEventClick},{item:c(({item:e})=>[o("div",Fe,[o("div",xe,[o("img",{src:e.featured_image_url||"/images/default-event.jpg",alt:e.title,loading:"lazy"},null,8,We),o("div",Ue,[o("span",{class:p([i.getStatusClass(e.status),"status-badge"])},s(i.getStatusLabel(e.status)),3)])]),o("div",He,[o("h3",null,s(e.title),1),o("p",null,s(i.getShortDescription(e.short_description)),1),o("div",qe,[o("span",Pe,[n(k,{name:"calendar_today",size:16}),d(" "+s(i.formatDate(e.start_date)),1)]),o("span",Ne,s(i.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"]),n(h,{title:"DerniÃ¨res VidÃ©os Dinor TV",items:i.latestVideos,loading:i.loadingVideos,error:i.errorVideos,"content-type":"videos","view-all-link":"/dinor-tv","disable-auto-navigation":!0,onItemClick:i.handleVideoClick,class:"dinor-tv-section"},{item:c(({item:e})=>[o("div",Oe,[o("div",Ke,[o("img",{src:e.thumbnail_url||i.getVideoThumbnail(e.video_url),alt:e.title,loading:"lazy"},null,8,Ge),o("div",Je,[o("div",Qe,[n(k,{name:"play_circle",size:48,color:"white"})]),e.is_live?(_(),r("div",Xe,t[2]||(t[2]=[o("span",{class:"live-dot"},null,-1),d(" LIVE ")]))):v("",!0),e.duration?(_(),r("div",Ye,s(i.formatDuration(e.duration)),1)):v("",!0)])]),o("div",Ze,[o("h3",null,s(e.title),1),o("p",null,s(i.getShortDescription(e.description)),1),o("div",et,[o("span",tt,[n(k,{name:"visibility",size:16}),d(" "+s(e.views_count||0),1)]),o("span",at,s(i.formatDate(e.created_at)),1)])])])]),_:1},8,["items","loading","error","onItemClick"])]),n(w,{modelValue:i.showAuthModal,"onUpdate:modelValue":[t[1]||(t[1]=e=>i.showAuthModal=e),i.closeAuthModal],"initial-message":i.authModalMessage,onAuthenticated:i.handleAuthSuccess},null,8,["modelValue","initial-message","onUpdate:modelValue","onAuthenticated"]),i.selectedVideo?(_(),b(D,{key:0,video:i.selectedVideo,onClose:i.closeVideo},null,8,["video","onClose"])):v("",!0)])}],["__scopeId","data-v-c2b1f0c1"]]);export{it as default};
